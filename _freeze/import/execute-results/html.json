{
  "hash": "f09ffa3d8655efe64bf0d67a43d18f20",
  "result": {
    "engine": "knitr",
    "markdown": "# Getting data into R {#sec-import}\n\n## Introduction <a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+09A+Introduction/1_qwkzetht\" target=\"_blank\">(Video)</a>\nIn this lesson we will introduce ways to get data from external files into R, how R works with data, and how to use functions to explore your data frame. \n\n\n::: {.callout-note}\n### Learning Objectives\n\nAfter completing this lesson learners will be able to\n\n* Import data that is stored in an external Excel, CSV or tab-delimited text file into R.\n* Compare and contrast the three file types discussed in this lesson. \n* Use functions to examine data objects to ensure data was imported correctly. \n:::\n\n\nOne advantage of keeping files separate (aside from your sanity)\nAll of the files within this folder can then be accessed using relative *paths*.\n\nThink of a *path* as driving directions to your instructors office in Holt Hall. It will be different for everyone if we start from your home. However, once you get onto campus, it's the same for everyone. \n\n* **Absolute paths** point to where a file is on a specific computer. \n    * Example: `/Users/rdonatello/Library/CloudStorage/Box-Box/Teaching/MATH 130/data` This path to the `data` folder only exists on Dr. Donatello's macbook. \n* **Relative paths** indicate where inside the project folder a file is located. \n    * Example: `MATH 130/data`. This path to the `data` folder once you're already in the `MATH 130` folder.  \n\n\nAdditionally, working this way makes it a lot easier to move your project around on your computer and share it with others without having to directly modify file paths in the individual scripts. This will be super important when we start importing data from an external file in @sec-import. \n\n\n:::{.callout-important}\n##### Prior to this lesson learners should\n\n* Download the [[09_import_notes.Rmd]](09_import_notes.Rmd) R markdown file and save into your `Math130/notes` folder. \n* Install the following packages: `gridExtra`, `RColorBrewer` and `sjPlot`.\n* Right click each link and save the following data sets into your `Math130/data` folder.\n\n:x: **DO NOT RENAME ANYTHING** If you download multiple copies of the data, do not keep the versions that have a (1) or some number in the name. Do not leave these files in your downloads folder. \n\n* [NCBirths](https://www.norcalbiostat.com/data/NCbirths.csv)\n* [email](https://www.norcalbiostat.com/data/email.txt)\n* [Police Shootings](https://www.norcalbiostat.com/data/fatal-police-shootings-data.xlsx)\n:::\n\n## File types <a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+09A+File+Types/1_9p0tuqjq\" target=\"_blank\">(Video)</a>\n\nIn this lesson we are only going to explore reading files that exist on your computer into R from three most commonly used data sources: A tab-delimited text file, A CSV file and an Excel file. \nThe three different files we will be using have different file types, or extensions.  \n\n* `email.txt` is a `.txt` or \"text\" file.\n* `NCBirths.csv` is a `.csv` or \"comma separated values\" file.\n* `fatal-police-shootings-data.xlsx` is a `.xlsx` or Excel file. \n\nEach of these file types differ in the type of _delimiter_ used. The _delimiter_ is a character or symbol that separates columns of data from each other when stored in an external file.  Recall back to the earlier lesson on data frames and matrices. Each column in the matrix represented data on a specific variable. Something had to tell R how to distinguish which values went with which variable. \n\nThere are two main types of delimiters we will consider in this class; comma and tab. That does not mean that data can't be stored in other ways, these are just the two most common. \n\nEach of these different data types requires a different function or mechanism to import the data into R. If you use the wrong mechanism, the data may not be read in correctly if at all. \n\n## General Importing data  <a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+09A+General+Importing+Data/1_o1ggmj66\" target=\"_blank\">(Video)</a>\n\nTo import data into R, we have to tell the program explicitly where to find the files you just downloaded. To do that we need to find the file's _path_. The _path_ is a programmatic way to direct your computer to the location of a file. It's like the file's address, or, where it lives on your computer. \n<!-- ([link](\"../static/img/path.png\") to picture to explain absolute vs relative path if there is time) -->\n\nIn all the examples below, the path shown (`data/`) is the path on **MY** computer. You will have to update this path to **YOUR** path on **YOUR** machine that points to your MATH130 folder. \n\nYou can find the path of a file by navigating to the desired file in your finder or browser window. Right click and copy the file to the clipboard, then right click and pasting into a R markdown file. This will show a path that looks something like this: \n\n```r\nfile:///C:/Math 130/Data/Challenger.txt\n```\n\nYou will need to remove the `file:///` part at the beginning before using this path. You will have three chances in this lab to practice this. \n\n\n### Special Instructions for Mac\n\n* Navigate to the file or folder you wish to copy the path for Right-click (or Control+Click, or a Two-Finger click on trackpads) on the file or folder in the Mac Finder\n* While in the right-click menu, hold down the OPTION key to reveal the “Copy (item name) as Pathname” option, which replaces the standard Copy option. Once selected, the file or folders path is now in the clipboard, ready to be pasted anywhere\n\n*Source: https://stackoverflow.com/questions/52695546/how-to-copy-path-of-a-file-in-mac-os*\n\n## Checking the import was successful\n\nThe first thing you should always do after importing a data file is look at the raw data and ask yourself the following things: \n\n1. Were the variable names read in correctly? \n2. Is there the expected number of rows and columns? \n3. Are the data types for each variable as expected? \n\nThere are many ways this can be done. Here are three:\n\n1. `str()` to show you the structure of the data frame. \n2. `head()` to show you the top 6 rows\n3. `data[1:x, 1:x]` - when the data frame is too large for the above two to work well, we can use matrix notation to view only the first X columns, and first X rows. \n\nNext we will read in three different data sets, each with unique file types, and look at each one to make sure it was read in correctly. \n\n## Text files\nText files are very simple files that have a `.txt` file extension. Common delimiters include a space, a comma (,) or a tab. Uncommon delimiters could include a % or even a semi-colon. By opening the file directly on your computer (not in R) you can see what delimiter is being used. \n\nWe will use the `read.table()` function that is in base R to read in any type of delimited file. A tab-delimited text file can be read in using `\"\\t\"` as the deliminator character. In this class you **ALWAYS** want to include `header=TRUE` to signify that the data in the first row contains our column names. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemail <- read.table(\"data/email.txt\", header=TRUE, sep=\"\\t\")\n```\n:::\n\n\n\n\n\nHere we call the `str()` or _structure_ function to examine the data that was imported. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(email)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t3921 obs. of  21 variables:\n $ spam        : int  0 0 0 0 0 0 0 0 0 0 ...\n $ to_multiple : int  0 0 0 0 0 0 1 1 0 0 ...\n $ from        : int  1 1 1 1 1 1 1 1 1 1 ...\n $ cc          : int  0 0 0 0 0 0 0 1 0 0 ...\n $ sent_email  : int  0 0 0 0 0 0 1 1 0 0 ...\n $ time        : chr  \"2011-12-31 22:16:41\" \"2011-12-31 23:03:59\" \"2012-01-01 08:00:32\" \"2012-01-01 01:09:49\" ...\n $ image       : int  0 0 0 0 0 0 0 1 0 0 ...\n $ attach      : int  0 0 0 0 0 0 0 1 0 0 ...\n $ dollar      : int  0 0 4 0 0 0 0 0 0 0 ...\n $ winner      : chr  \"no\" \"no\" \"no\" \"no\" ...\n $ inherit     : int  0 0 1 0 0 0 0 0 0 0 ...\n $ viagra      : int  0 0 0 0 0 0 0 0 0 0 ...\n $ password    : int  0 0 0 0 2 2 0 0 0 0 ...\n $ num_char    : num  11.37 10.5 7.77 13.26 1.23 ...\n $ line_breaks : int  202 202 192 255 29 25 193 237 69 68 ...\n $ format      : int  1 1 1 1 0 0 1 1 0 1 ...\n $ re_subj     : int  0 0 0 0 0 0 0 0 0 0 ...\n $ exclaim_subj: int  0 0 0 0 0 0 0 0 0 0 ...\n $ urgent_subj : int  0 0 0 0 0 0 0 0 0 0 ...\n $ exclaim_mess: int  0 1 6 48 1 1 1 18 1 0 ...\n $ number      : chr  \"big\" \"small\" \"small\" \"small\" ...\n```\n\n\n:::\n:::\n\n\n\n\n\n* The `email` data set has 3921 observations, and 21 variables. \n* The variable names were read in correctly, as evidenced by the words in the far right corner after the `$`. \n* Most variables are treated as numeric integers, except a few are factors. Including `time`. If we wanted to examine a time trend, we would need to convert the class into a `datetime` \n\n> What happens if you forget to include the arguments for `header` or `sep`? Try that now and discuss what happened. \n<!-- > What happens if you forget to include the arguments for `header` or `sep`? Try that now and discuss with your neighbor what happened.  -->\n\n**Forgetting both arguments**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemail <- read.table(\"data/email.txt\")\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in read.table(\"data/email.txt\"): duplicate 'row.names' are not allowed\n```\n\n\n:::\n:::\n\n\n\n\n\n**Forgetting the header**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemail <- read.table(\"data/email.txt\", sep=\"\\t\")\nhead(email)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    V1          V2   V3 V4         V5                  V6    V7     V8     V9\n1 spam to_multiple from cc sent_email                time image attach dollar\n2    0           0    1  0          0 2011-12-31 22:16:41     0      0      0\n3    0           0    1  0          0 2011-12-31 23:03:59     0      0      0\n4    0           0    1  0          0 2012-01-01 08:00:32     0      0      4\n5    0           0    1  0          0 2012-01-01 01:09:49     0      0      0\n6    0           0    1  0          0 2012-01-01 02:00:01     0      0      0\n     V10     V11    V12      V13      V14         V15    V16     V17\n1 winner inherit viagra password num_char line_breaks format re_subj\n2     no       0      0        0    11.37         202      1       0\n3     no       0      0        0   10.504         202      1       0\n4     no       1      0        0    7.773         192      1       0\n5     no       0      0        0   13.256         255      1       0\n6     no       0      0        2    1.231          29      0       0\n           V18         V19          V20    V21\n1 exclaim_subj urgent_subj exclaim_mess number\n2            0           0            0    big\n3            0           0            1  small\n4            0           0            6  small\n5            0           0           48  small\n6            0           0            1   none\n```\n\n\n:::\n:::\n\n\n\n\n\n**Forgetting the separator**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemail <- read.table(\"data/email.txt\", header=TRUE)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in read.table(\"data/email.txt\", header = TRUE): duplicate 'row.names' are not allowed\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(email)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    V1          V2   V3 V4         V5                  V6    V7     V8     V9\n1 spam to_multiple from cc sent_email                time image attach dollar\n2    0           0    1  0          0 2011-12-31 22:16:41     0      0      0\n3    0           0    1  0          0 2011-12-31 23:03:59     0      0      0\n4    0           0    1  0          0 2012-01-01 08:00:32     0      0      4\n5    0           0    1  0          0 2012-01-01 01:09:49     0      0      0\n6    0           0    1  0          0 2012-01-01 02:00:01     0      0      0\n     V10     V11    V12      V13      V14         V15    V16     V17\n1 winner inherit viagra password num_char line_breaks format re_subj\n2     no       0      0        0    11.37         202      1       0\n3     no       0      0        0   10.504         202      1       0\n4     no       1      0        0    7.773         192      1       0\n5     no       0      0        0   13.256         255      1       0\n6     no       0      0        2    1.231          29      0       0\n           V18         V19          V20    V21\n1 exclaim_subj urgent_subj exclaim_mess number\n2            0           0            0    big\n3            0           0            1  small\n4            0           0            6  small\n5            0           0           48  small\n6            0           0            1   none\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## CSV: Comma Separated Values\nCSV is a fancy way of saying a text file with comma-separated values (i.e. CSV). This file type can also open in Excel--the icons even look similar. We could use `read.table()` to import this data file, but `read.csv()` is optimized to read in CSV files. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNCbirths <- read.csv(\"data/NCbirths.csv\", header=TRUE)\nhead(NCbirths)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  fage mage      mature weeks    premie visits marital gained weight\n1   NA   13 younger mom    39 full term     10 married     38   7.63\n2   NA   14 younger mom    42 full term     15 married     20   7.88\n3   19   15 younger mom    37 full term     11 married     38   6.63\n4   21   15 younger mom    41 full term      6 married     34   8.00\n5   NA   15 younger mom    39 full term      9 married     27   6.38\n6   NA   15 younger mom    38 full term     19 married     22   5.38\n  lowbirthweight gender     habit  whitemom\n1        not low   male nonsmoker not white\n2        not low   male nonsmoker not white\n3        not low female nonsmoker     white\n4        not low   male nonsmoker     white\n5        not low female nonsmoker not white\n6            low   male nonsmoker not white\n```\n\n\n:::\n:::\n\n\n\n\n\n* The `NCbirths` data set has 1000 rows and 13 columns. \n* Variable names are read in OK. \n* Most the data is begin read in as factors and integers. \n* There are some `NA` values for the variable `fage` (fathers age). \n\n\n## Excel files\n\nThe best method to read in Excel files is from the [`readxl` package](http://readxl.tidyverse.org/) by [Hadley Wickham](http://hadley.nz/). This package need to be installed first, and then can be simply loaded using the `library()` function each time you start an `R` session where you will be reading in this type of data. \n\nThe `read_excel()` function is what we are going to use. Note the use of the underscore `_` instead of a period `.` between `read` and `excel`. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npolice  <- read_excel(\"data/fatal-police-shootings-data.xlsx\", sheet=1, col_names=TRUE)\npolice[1:10,1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 5\n      id name                date                manner_of_death  armed     \n   <dbl> <chr>               <dttm>              <chr>            <chr>     \n 1     3 Tim Elliot          2015-01-02 00:00:00 shot             gun       \n 2     4 Lewis Lee Lembke    2015-01-02 00:00:00 shot             gun       \n 3     5 John Paul Quintero  2015-01-03 00:00:00 shot and Tasered unarmed   \n 4     8 Matthew Hoffman     2015-01-04 00:00:00 shot             toy weapon\n 5     9 Michael Rodriguez   2015-01-04 00:00:00 shot             nail gun  \n 6    11 Kenneth Joe Brown   2015-01-04 00:00:00 shot             gun       \n 7    13 Kenneth Arnold Buck 2015-01-05 00:00:00 shot             gun       \n 8    15 Brock Nichols       2015-01-06 00:00:00 shot             gun       \n 9    16 Autumn Steele       2015-01-06 00:00:00 shot             unarmed   \n10    17 Leslie Sapp III     2015-01-06 00:00:00 shot             toy weapon\n```\n\n\n:::\n:::\n\n\n\n\n\n\n* The variable `date` is a `dttm` or _date-time_ variable. This means `R` recognizes it directly as a date, not some string of numbers. \n* Categorical variables such as `manner_of_death` and `city` are read in as `character` instead of factor. We may or may not want to change that later.\n* Numeric variables such as `age` are of type `dbl` (double). This is similar to `integer` or `numeric`, so we are fine. \n\n\n",
    "supporting": [
      "import_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}