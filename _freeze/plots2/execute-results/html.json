{
  "hash": "2ebf840daebf7e02d33c894f9ac9e188",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute:\n  fig-height: 4\nformat: \n  html:\n    toc-depth: 3\n---\n# Plot Enhancements {#sec-plots2}\n\n:::{.callout-warning icon=false appearance=minimal}\n<a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+10A+Introduction/1_qmt3ls9l\" target=\"_blank\">Lesson Introduction Video</a>\n:::\n\nSection @sec-plots1 introduced the main plotting packages `ggplot2`, `ggpubr`, and `sjPlot` and focused on creating the correct graphics for the data types. This lesson expands on those tools and demonstrates how to customize some features and add enhancements to clarify or to add information to a plot. \n\n:::{.callout-note title = \"ðŸŽ“ Learning Objectives\" icon=false}\n\nAfter completing this lesson students will be able to\n\n* Change the color and shape of geometries in a plot\n* Layer on multiple types of geometries onto a single plot\n* Create a grid/panel of plots to create multivarible plots\n* Adjust themes, legends, and titles\n\n:::\n\n:::{.callout-important title = \"Too much to memorize!\"}\nThere is *NO* need to remember all of these adjustments when there are incredibly handy reference guides and \"cookbooks\" available. \n\n* https://r-graphics.org/\n* https://r-graph-gallery.com\n* https://ggplot2.tidyverse.org/reference/index.html \n* https://r-charts.com\n\nThis lesson also has no specific order, but is a smattering of \"things you should know\". \n:::\n\n:::{.callout-tip title = \"ðŸ‘‰ Prepare\" icon=false}\n\n1.  Open your Math 130 R Project.\n2.  Right click and \"save as\" this lessons [[Quarto notes file]](notes/plots2_notes.qmd) and save into your `Math130/notes` folder.\n3.  In the *Files* pane, open this Quarto file and Render this file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # ggplot, forcats\nlibrary(ggpubr)\nemail <- openintro::email\nlibrary(paletteer)\nNCbirths <- openintro::ncbirths\npen <- palmerpenguins::penguins\n```\n:::\n\n\n:::\n\nThis lesson uses several data sets that we have seen in prior lessons. \n\n## Reorder barcharts in decreasing order\n\nWe can reorder these levels on the fly so they are being shown in decreasing frequency using the `fct_infreq` function from the `forcats` library. You can add this layer to both `ggplot` and `ggpubr` creations. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(pen, aes(\n  x=fct_infreq(island))) + \n  geom_bar() + xlab(\"Island\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n## Flipping the axis\n\nSometimes barcharts and boxplots look better horizontally, especially when the category labels are long,  but the default is vertical. We can add a `coord_flip` layer to nearly any plot to rotate it 90*. \n\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nggplot(pen, aes(x=island)) + geom_bar() +  \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggboxplot(pen, y= \"body_mass_g\", x = \"island\") + \n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n\n## A \"better\" Pie chart\n\nWe need to pre-calculate the percentages first, then plot those summary numbers. So we will chain functions from `dplyr` and `ggpubr` together. \n\n[See the [R graph gallery](https://r-graph-gallery.com/piechart-ggplot2.html) for how to make a pie chart in `ggplot`.]{.aside}\n\n\n::: {.cell code-annotations='below'}\n\n```{.r .cell-code}\npen %>%  # <1>\n  group_by(island) %>%  # <2>\n  tally() %>% # <3>\n  mutate(pct = scales::percent(n/sum(n)),  # <4>\n         labs = paste0(island, \"\\n n=\", n, \"(\", pct, \")\")) %>%  # <5>\n  ggpie(x = \"n\",  # <6>\n        label = \"labs\",  # <7>\n        fill = \"island\",  # <8>\n        lab.pos = \"in\") # <9>\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n1. Take the `penguin` data set\n2. perform these calculations for each `island` separately\n3. `tally()` counts the number of records by group (like `table`), and stores it in a new variable named `n` (this is a default name)\n4. create a new variable `pct` that calculates the percent in each group by dividing the group count `n`, by the total number of records `sum(n)`, then using the `percent` function from the `scales` package to display this decimal as a percent\n5. Create chart labels by `paste`ing the value of the variable `island`, then a line break (new line) `\\n`, then the text `n=`, then the value of the variable `n`, followed by the value of the percent variable `pct` wrapped in parenthesis\n6. pass all of this summarized data into `ggpie` - the function to create the pie chart, and specify that the numbers to be plotted is in the variable `n`\n7. and that the wedge labels are found in the variable `labs` that was created in step 5\n8. color the wedges based on the `island` variable\n9. and put these labels inside the circle\n\n\n## Adding the mean\n\nAdding annotation on a numeric distribution plot to indicate where the mean is located is often a nice informative feature. \n\n::: {.panel-tabset}\n## ggplot2\n\nThe mean can be denoted on `geom_histogram` or `geom_density` using a vertical line (`geom_vline`) where the `xintercept` is set as the calculated mean of the variable being plotted. \n\nWith boxplots and violins, the code below uses the `stat_summary` layer to add the `mean` as a summary `fun`ction, we plot it as a `point` on the graph, `shape=17` makes it a triangle (see `?pch` for more shapes), `size=4` makes it a bit larger so it stands out. There are also `color` and `fill` options available if desired. \n\n\n::: {.cell layout-ncol=\"2\" source-line-numbers='3-4, 8-10'}\n\n```{.r .cell-code}\nggplot(pen, aes(x=body_mass_g)) + \n  geom_histogram() + \n  geom_vline(aes(xintercept=mean(body_mass_g, na.rm = TRUE)),\n            color=\"blue\", linetype=\"dashed\")\n```\n\n::: {.cell-output-display}\n![using `geom_vline` to add to a histogram or density](plots2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(pen, aes(y=body_mass_g, x = island)) + \n  geom_boxplot() + \n  stat_summary(fun=\"mean\", geom=\"point\", \n               shape=17, size=4) \n```\n\n::: {.cell-output-display}\n![using `stat_summary` to add the mean to a boxplot](plots2_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\nPlay around with the `shape`, `fill`/`color`, and `size` until you achieve your desired look. \n\n## ggpubr\n\nWith `ggpubr` you can use use the `add=\"mean\"` argument to both `gghistogram` and `ggdensity` to add a vertical dashed line to denote the location of the mean.  \n\n\n::: {.cell layout-ncol=\"2\" source-line-numbers='2,4'}\n\n```{.r .cell-code}\ngghistogram(pen, x=\"body_mass_g\", fill = \"species\",\n            add = \"mean\",)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggboxplot(pen, y=\"body_mass_g\", x = \"species\", fill = \"species\", \n          add = \"mean_se\", add.params = list(color = \"white\"))\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\nWith `ggpboxplot`, you can `add` many summary statistics such as the mean as a dot and line representing uncertainty such as the standard deviation (sd) and standard error (se). I also used `add.params` to make the color of these means easier to see. \nSee the `add` and `add.params` entries in the help file for `?ggboxplot` for more options. \n\n:::\n\n### Histograms + density curve\n\nOften it is more helpful to have the density (or kernel density) plot _on top of_ a histogram plot. \n\n::: {.panel-tabset}\n## `ggplot2`\n\n\n::: {.cell code-annotations='below'}\n\n```{.r .cell-code}\nggplot(pen, aes(x=body_mass_g)) +   # <1>\n  geom_density(col=\"blue\") + \n  geom_histogram(aes(y=..density..), colour=\"black\", # <2>\n                 fill=NA) # <3>\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n1. The syntax starts the same: we'll add a `geom_density` and color the line blue for funsies. \n2. Then we add the histogram geom using `geom_histogram` but must specify that the y axis should be on the density, not frequency, scale. Note that this has to go inside the aesthetic statement `aes()`. \n3. I'm also going to get rid of the fill by using `NA` so the colored bars don't plot over the density line. \n\n## `ggpubr`\n\nYou start with a `gghistogram` and then `add_denstity` to the plot. This does not always work well with every variable. Sometimes the density plot is too small to view. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\ngghistogram(pen, x = \"bill_depth_mm\", fill = \"species\", \n            add_density = TRUE)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n:::\n\n\n## Adding violins to a boxplot\n\nA violin plot is like a density plot, turned on its side, and reflected around the axis for symmetry purposes. Overlaying a boxplot and a violin plot serves a similar purpose to Histograms + Density plots. It shows outliers, the location of most the data, and better shows the shape/skew of the distribution.\n\n::: {.panel-tabset}\n## ggplot2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pen, aes(x=body_mass_g, y=island, fill=island)) +\n        geom_violin(alpha=.1) + \n        geom_boxplot(alpha=.5, width=.2)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## ggpubr\n\nWe start with a `ggviolin` and then add a `boxplot`. Note that I also add `coord_flip()` to change the orientation of the boxplots to horizontal. \n\n::: {.cell}\n\n```{.r .cell-code}\nggviolin(pen, \n  x=\"island\", y = \"body_mass_g\", \n  color = \"island\", add = c(\"mean\", \"boxplot\")) + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n:::\n\n\n\n## Themes \n\n:::{.callout-warning icon=false appearance=minimal}\n<a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+10A+Themes/1_kwh2ucf7\" target=\"_blank\">Themes Video</a>\n:::\n\nThe standard theme has a gray background, white grid lines etc. \nThemes can be changed by adding `theme_X()` where `X` has several options\n\n\n::: {.cell layout-ncol=\"3\" source-line-numbers='2, 4, 6'}\n\n```{.r .cell-code}\nggplot(email, aes(x=line_breaks, y=num_char)) + geom_point() + \n  theme_bw()\nggplot(email, aes(x=line_breaks, y=num_char)) + geom_point() + \n  theme_void()\nggplot(email, aes(x=line_breaks, y=num_char)) + geom_point() + \n  theme_dark()\n```\n\n::: {.cell-output-display}\n![theme_bw()](plots2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![theme_void()](plots2_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![theme_dark()](plots2_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n:::\n\n\nExplore tons more themes at [https://r-charts.com/ggplot2/themes/](https://r-charts.com/ggplot2/themes/)\n\n## Legends (keys)\n\n:::{.callout-warning icon=false appearance=minimal}\n<a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+10A+Legends/1_schkl6as\" target=\"_blank\">Modifying plot legends video</a>\n:::\n\n\n### Title of legend\n\nAdd the `name=` argument to whatever layer you added that created the legend. Here I specified a `fill`, and it was a `discrete` variable. So I use the `scale_fill_discrete()` layer. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, fill=number)) + geom_boxplot() + \n  scale_fill_discrete(name=\"Size of number\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nHere I `col`or the box outlines so the layer is `scale_color_discrete()`.\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + geom_boxplot() + \n  scale_color_discrete(name=\"Size of number\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### Moving & removing the legend\n\n::: {.panel-tabset}\n## Moving\n\nThe `legend.position` can be controlled using a `theme()` layer. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + geom_boxplot() + \n  theme(legend.position = \"top\") \n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nNote that this involves a call to `theme()`. If you have apply a named theme like `theme_bw()` _after_ setting legend.position using `theme`, it will overwrite that modification. The order of ggplot layers matters. \n\n\n::: {.cell layout-ncol=\"2\" source-line-numbers='2-3'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + geom_boxplot() + \n  theme(legend.position = \"top\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + geom_boxplot() + \n  theme_minimal() + \n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n\n\n## Removing\n\nSometimes the legend is not needed. It's providing redundant information and takes up space, so let's remove it entirely by adding `guide=\"none\"` to the `scale_` layer. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + geom_boxplot() + \n  scale_color_discrete(guide=\"none\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n:::\n\n\n## Title and axis labels\n\n:::{.callout-warning icon=false appearance=minimal}\n<a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+10A+Titles/1_xvnu92g7\" target=\"_blank\">Lesson Video</a>\n:::\n\nA good plot needs to stand alone and convey as much information as possible. `ggplot2` provides a single `labs` function that is very versitile and includes options for alt-text as well. See `?labs` for more information\n\n* `title` for an overall plot title\n* `y` and `x` adjust the axis labels. \n* using `\\n` creates a line break\n\n\n::: {.cell source-line-numbers='4-6'}\n\n```{.r .cell-code}\nggplot(email, aes(y=num_char, x=number, col=number)) + \n  geom_boxplot() + \n  scale_color_discrete(guide=\"none\") + \n  labs(\n    title = \"Distribution of the number of characters in an email \\n based on the size of the number in the email\", \n    x = \"Size of number in email\", \n    y = \"Number of characters\"\n  )\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Changing colors \n\nFull guide on how to change colors in `ggplot2` at [https://r-graph-gallery.com/ggplot2-color.html](https://r-graph-gallery.com/ggplot2-color.html)\n\n::: {.panel-tabset}\n## Manual\n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(email, aes(x=number, fill=number)) + geom_bar() +\n    scale_fill_manual(values=c(\"red\", \"green\", \"blue\"))\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nThere's some spectacularly colors available. See [https://r-charts.com/colors/](https://r-charts.com/colors/) for the full list. You can also type `colors()` in the console. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(email, aes(x=number, fill=number)) + geom_bar() +\n    scale_fill_manual(values=c(\"salmon\", \"slategray4\", \"violet\"))\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n \nAnd you can use [hex colors](https://www.w3schools.com/colors/colors_picker.asp)\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(email, aes(x=number, fill=number)) + geom_bar() +\n    scale_fill_manual(values=c(\"#47dbff\", \"#b3b3cc\", \"#ff531a\"))\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n## Using a color palette (recommended)\n\nThere are 3 types of palettes:\n\n* **_Sequential_** palettes are suited to ordered data that progress from low to high. Lightness steps dominate the look of these schemes, with light colors for low data values to dark colors for high data values.\n\n* **_Diverging_** palettes put equal emphasis on mid-range critical values and extremes at both ends of the data range. The critical class or break in the middle of the legend is emphasized with light colors and low and high extremes are emphasized with dark colors that have contrasting hues.\n\n* **_Qualitative_** palettes do not imply magnitude differences between legend classes, and hues are used to create the primary visual differences between classes. Qualitative schemes are best suited to representing nominal or categorical data.\n\n### R ColorBrewer\nOne of the most common color pallet packages used. See the [full set of palettes available](https://r-graph-gallery.com/38-rcolorbrewers-palettes.html). \n\nThe function to use is `scale_fill_brewer` (or `scale_color_brewer`), with an argument specifying the palette name in quotes. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\nggplot(email, aes(x=number, fill=number)) + geom_bar() +\n    scale_fill_brewer(palette = \"Dark2\")\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n### Viridis\n\n`viridis` provide a series of color maps that are designed to improve graph readability for readers with common forms of color blindness and/or color vision deficiency. [Eight scales are available](https://sjmgarnier.github.io/viridisLite/reference/viridis.html), but `magma`, `inferno`, `plasma`, and `viridis` as defined in Matplotlib for Python. These color maps are designed in such a way that they will analytically be perfectly perceptually-uniform, both in regular form and also when converted to black-and-white. They are also designed to be perceived by readers with the most common form of color blindness. \n\nIf you are `fill`ing or `col`oring by a categorical variable, you'll use the corresponding `scale_fill_discrete` or `scale_color_discrete` function, and then pass the name of the palette with the number of levels needed as a function to the `palette` argument. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(viridisLite)\nggplot(email, aes(x=number, fill=number)) + geom_bar() +\n    scale_fill_discrete(palette = magma(3))\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n:::\n\n\n## Multivariate plotting \n\n:::{.callout-warning icon=false appearance=minimal}\n<a href=\"https://media.csuchico.edu/media/MATH+130+-+Lecture+10A+Multivariate+Plotting/1_xp1whb0f\" target=\"_blank\">Multivariate plotting video</a>\n:::\n\nSo far we've only looked at how to plot 2 variables on the same plot. Let's up our game some. \n\n::: {.panel-tabset}\n## Boxplots with three variables\n\nIn the first plotting lesson, we `fill`ed the boxes with the same categorical variable that was on the x axis. We can also fill (or color) the boxes by a third variable if you want an additional comparison. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(NCbirths, aes(y=weeks, x=mature, fill=habit)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nThis lets us compare the distribution of gestation period for smokers vs non smokers, within mature and younger moms. \n\n## Scatterplots\n\n\n::: {.cell code-annotations='below'}\n\n```{.r .cell-code}\nNCbirths %>%   # <1>\n  select(weeks, weight, habit) %>% \n  filter(!is.na(habit)) %>% \nggplot(aes(x=weeks, y=weight, color = habit)) +  # <2>\n         geom_point() + geom_smooth(se=FALSE) + \n  theme_minimal() + scale_color_brewer(palette = \"Set1\") # <3>\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n1. Starting with the `NCbirths` data set, I `select` the variables i want to plot, and then use `filter` to drop rows with missing values for `habit`. \n2. Create a scatterplot for gestation `weeks` against baby `weight`, coloring by the mothers smoking `habit`. Add both points and loess lines. \n3. Make the graph more visually readable by modifying the theme and adding a color palette. \n\n:::\n\n\n## Faceting / paneling \n\nggplot introduces yet another term called `faceting`. The definition is _a particular aspect or feature of something_, or _one side of something many-sided, especially of a cut gem_. Basically instead of plotting the grouped graphics on the same plotting area, we let each group have it's own plot, or facet.  \n\nWe add a `facet_wrap()` and specify the variable we want to panel on after the `~` tilde. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(NCbirths, aes(x=mage, fill=gender)) + geom_density(alpha=.3) +\n  facet_wrap(~mature)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nThe grid placement can be semi-controlled by using the `ncol` argument in the `facet_wrap()` statement. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nggplot(NCbirths, aes(x=mage, fill=gender)) + geom_density(alpha=.3) +\n  facet_wrap(~mature, ncol=1)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nIt is important to compare distributions across groups on the same scale, and our eyes can compare items vertically better than horizontally. \n\n### Paneling on two variables\n\nWho says we're stuck with only faceting on one variable? Using`facet_grid(` we can specify multiple variables to panel on. \n\n\n::: {.cell source-line-numbers='2'}\n\n```{.r .cell-code}\nNCbirths %>%   # <1>\n  select(weeks, marital, habit, mature) %>% \n  filter(!is.na(habit)) %>% \nggplot(aes(x=weeks, fill=mature)) + geom_density(alpha=.2) + facet_grid(marital~habit)\n```\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-27-1.png){width=960}\n:::\n:::\n\n\n* Distribution of weeks\n* colored by maturity status\n* paneled on the combination of smoking habit and marital status\n\n## Multiple plots per window\n\nWe can set the number of columns figures show up in using code chunk option:  `layout-ncol`. This method works only in Quarto documents. \n\n\n\n::: {.cell layout-ncol=\"2\"}\n\n````{.cell-code}\n```{{r}}\n#| layout-ncol: 2\nggplot(pen, aes(x=body_mass_g, fill=species)) + geom_density(alpha=.2)\nggplot(pen, aes(x=body_mass_g, col=island)) + geom_density() \n```\n````\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](plots2_files/figure-html/unnamed-chunk-28-2.png){width=672}\n:::\n:::\n\n\n\n\n\n\n",
    "supporting": [
      "plots2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}